---
id: DS-015
title: Smart Status Transitions
type: feature
epic: EPIC-003
status: done
sprint: phase-3
size: M
assignee: ""
dependencies:
  - [[DS-004]]
created: 2025-11-26
updated: 2025-11-28
---

# Smart Status Transitions

## Description
Intuitive status management with workflow-aware suggestions, bulk operations, and contextual prompts for common transitions.

## Acceptance Criteria

### MVP
- [x] Context menu on tree item: "Change Status →"
- [x] Submenu lists all statuses from config.yaml
- [x] Current status shown with checkmark
- [x] Selecting status updates frontmatter `status` field
- [x] Auto-updates `updated` timestamp
- [x] Preserves all other file content
- [x] Tree view refreshes immediately

### Enhanced
- [ ] **Workflow hints**: Highlight "next logical" status based on current:
  - `todo` → suggests `in_progress`
  - `in_progress` → suggests `review`
  - `review` → suggests `done`
- [ ] **Bulk status change**: Multi-select stories in tree → change all at once
- [ ] **Assignee prompt**: When moving to `in_progress`, prompt to set assignee if empty
- [ ] **Completion actions**: When moving to `done`:
  - Brief celebration notification (configurable, default: subtle)
  - Option: "Close related stories?" if dependencies exist
- [ ] **Keyboard shortcuts**: Quick status cycle without mouse
  - `Space` on selected story → next status in workflow
- [ ] **Status history**: Track status changes with timestamps (in frontmatter or separate)

## Technical Notes
- Context menu: `package.json` → `menus.view/item/context`
- Bulk select: VS Code tree view supports multi-select with `canSelectMany: true`
- Frontmatter update: Use gray-matter to parse, modify, stringify
- Preserve content: Only modify YAML block, leave markdown body untouched

## User Flow

### Single Story Status Change
```
1. Right-click story in tree
2. "Change Status →" submenu appears
3. See: ○ To Do, ◉ In Progress (current), ○ Review (suggested), ○ Done
4. Click "Review"
5. → File updated, tree refreshed
```

### Bulk Status Change
```
1. Cmd+Click to select multiple stories in tree
2. Right-click → "Change Status →"
3. Select "Done"
4. → All selected stories updated
5. → Notification: "Updated 3 stories to Done"
```

### Quick Workflow Advance
```
1. Select story in tree
2. Press Space
3. → Status advances: todo → in_progress → review → done
4. → Cycles back to todo after done (or stops at done, configurable)
```

## Package.json Config

```json
{
  "menus": {
    "view/item/context": [
      {
        "command": "devstories.changeStatus",
        "when": "view == devstoriesTree && viewItem == story",
        "group": "inline"
      }
    ]
  },
  "commands": [
    {
      "command": "devstories.changeStatus",
      "title": "Change Status",
      "icon": "$(circle-outline)"
    },
    {
      "command": "devstories.advanceStatus",
      "title": "Advance to Next Status"
    }
  ],
  "keybindings": [
    {
      "command": "devstories.advanceStatus",
      "key": "space",
      "when": "focusedView == devstoriesTree"
    }
  ]
}
```

## Status History (Enhanced - Optional)

If tracking status history, add to frontmatter:

```yaml
status_history:
  - status: todo
    timestamp: 2025-01-15T10:00:00Z
  - status: in_progress
    timestamp: 2025-01-16T09:30:00Z
    assignee: "dhaval"
  - status: done
    timestamp: 2025-01-18T14:00:00Z
```

This enables future analytics: cycle time, time in status, etc.
