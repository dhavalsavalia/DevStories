---
id: DS-016
title: Link Detection + Validation
type: feature
epic: EPIC-004
status: done
sprint: phase-4
size: M
assignee: ""
dependencies:
  - DS-004
created: 2025-11-26
updated: 2025-11-28
---

# Link Detection + Validation

## Description
Core link detection system that identifies `[[ID]]` patterns, resolves them to files, and provides validation for broken links.

## Acceptance Criteria

### MVP
- [x] Regex correctly identifies `[[ID]]` pattern in document text
- [x] `LinkResolver.resolve(id)` returns absolute file path
- [x] Handles case where ID does not exist (returns null)
- [x] Supports both Story and Epic IDs
- [x] Works with custom ID prefixes from config

### Enhanced
- [x] **Broken link detection**: Identify `[[INVALID-ID]]` that don't resolve
- [ ] **Diagnostic integration**: Report broken links as VS Code warnings
- [ ] **Quick fix**: "Create story INVALID-ID?" action for broken links
- [ ] **Backlinks index**: Track which stories link to which (for backlinks panel later)
- [ ] **Autocomplete**: Suggest valid IDs when typing `[[`

## Technical Notes
- Regex: `/\[\[([A-Z]+-\d+)\]\]/g` (configurable prefix)
- LinkResolver should use Store to check ID existence
- Diagnostics via `vscode.languages.createDiagnosticCollection()`
- Backlinks: Build reverse index on store load, update on file change

## Link Patterns

| Pattern | Resolution |
|---------|------------|
| `[[DS-001]]` | `.devstories/stories/DS-001.md` |
| `[[EPIC-001]]` | `.devstories/epics/EPIC-001.md` |
| `[[STORY-123]]` | `.devstories/stories/STORY-123.md` |
| `[[INVALID]]` | null (broken link) |

## Autocomplete (Enhanced)

When user types `[[`, show completion list:
```
[[
  DS-001 - Project Scaffolding
  DS-002 - Markdown Parser
  EPIC-001 - Phase 1: Foundation
  ...
```

Use `vscode.languages.registerCompletionItemProvider()` with trigger `[`.
