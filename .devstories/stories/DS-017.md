---
id: DS-017
title: Clickable Links + Navigation
type: feature
epic: EPIC-004
status: done
sprint: phase-4
size: S
assignee: ""
dependencies:
  - [[DS-016]]
created: 2025-11-26
updated: 2025-11-28
---

# Clickable Links + Navigation

## Description
Make `[[ID]]` links clickable in the editor with Ctrl/Cmd+Click navigation to the referenced file.

## Acceptance Criteria

### MVP
- [x] Implement `DocumentLinkProvider` interface
- [x] `provideDocumentLinks` returns ranges for all `[[ID]]` occurrences
- [x] Links have correct target URI pointing to resolved file
- [x] Ctrl+Click (Cmd+Click on Mac) opens the target file
- [x] Works in both Story and Epic markdown files
- [x] Broken links don't crash (graceful handling)

### Enhanced
- [ ] **Visual distinction**: Broken links styled differently (dimmed or red underline)
- [ ] **Peek definition**: Alt+F12 on link shows inline preview without opening file
- [ ] **Go to references**: Find all stories that link to current story
- [ ] **Breadcrumb integration**: Show epic in breadcrumb when viewing story

## Technical Notes
- Register provider: `vscode.languages.registerDocumentLinkProvider('markdown', provider)`
- DocumentLink needs `range` and `target` (Uri)
- Use LinkResolver from DS-016 for resolution
- Broken links: Return link with no target, or skip entirely

## Implementation

```typescript
class StoryLinkProvider implements vscode.DocumentLinkProvider {
  provideDocumentLinks(document: vscode.TextDocument): vscode.DocumentLink[] {
    const links: vscode.DocumentLink[] = [];
    const text = document.getText();
    const regex = /\[\[([A-Z]+-\d+)\]\]/g;

    let match;
    while ((match = regex.exec(text)) !== null) {
      const id = match[1];
      const resolved = this.linkResolver.resolve(id);
      if (resolved) {
        const startPos = document.positionAt(match.index);
        const endPos = document.positionAt(match.index + match[0].length);
        const range = new vscode.Range(startPos, endPos);
        links.push(new vscode.DocumentLink(range, vscode.Uri.file(resolved)));
      }
    }
    return links;
  }
}
```
