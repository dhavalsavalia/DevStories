---
id: DS-074
title: Implement MCP server for reading stories
type: feature
epic: EPIC-015
status: todo
sprint: future-1
size: L
assignee: ""
dependencies: []
created: 2025-11-29
updated: 2025-11-29
---

# Implement MCP server for reading stories

## Description
Create Model Context Protocol server to expose DevStories data to AI agents (Claude Code, Cursor, Codex, etc).

## Acceptance Criteria

### Package Setup
- [ ] Create `packages/mcp-server/` directory
- [ ] Initialize with `@modelcontextprotocol/sdk` dependency
- [ ] Configure as standalone executable (`npx devstories-mcp`)
- [ ] Add to VS Code extension's MCP server recommendations

### Resources (Read-Only Data)

**`devstories://config`**
- [ ] Returns project config (statuses, sizes, current sprint, prefixes)

**`devstories://epics`**
- [ ] List all epics with: id, title, status, story count, progress %
- [ ] Sorted by status (in_progress first, then todo, then done)

**`devstories://epic/{id}`**
- [ ] Single epic with full details + child stories list

**`devstories://stories`**
- [ ] List all stories with: id, title, type, status, epic, sprint, size
- [ ] Support query params: `?sprint=polish-1`, `?status=todo`, `?epic=EPIC-010`

**`devstories://story/{id}`**
- [ ] Full story details including markdown content
- [ ] Include resolved epic title (not just ID)
- [ ] Include dependency titles (not just IDs)

**`devstories://sprint/{name}`**
- [ ] Stories in sprint grouped by status
- [ ] Sprint progress stats (done/total, %)

**`devstories://next`**
- [ ] Suggest next story to work on (first todo in current sprint, respecting dependencies)

### Prompts (AI Templates)

**`status_report`**
- [ ] "Generate sprint status report" - returns formatted progress summary

**`plan_feature`**
- [ ] "Break down this feature into stories" - template for story breakdown

### Response Format
- [ ] All responses in structured JSON
- [ ] Include `_links` for related resources (HATEOAS-style)
- [ ] Consistent error format: `{ error: string, code: string }`

### Testing
- [ ] Unit tests for each resource
- [ ] Integration test with MCP Inspector
- [ ] Test with Claude Code manually

## Technical Notes

**MCP SDK:** https://github.com/modelcontextprotocol/typescript-sdk

**Package structure:**
```
packages/mcp-server/
├── src/
│   ├── index.ts          # Server entry point
│   ├── resources/        # Resource handlers
│   │   ├── config.ts
│   │   ├── epics.ts
│   │   ├── stories.ts
│   │   └── sprint.ts
│   ├── core/             # Reuse from main extension
│   │   └── ... (parser, store, types)
│   └── utils/
│       └── responses.ts  # Response formatting
├── package.json
└── tsconfig.json
```

**Claude Code config example:**
```json
{
  "mcpServers": {
    "devstories": {
      "command": "npx",
      "args": ["devstories-mcp", "--workspace", "."]
    }
  }
}
```
