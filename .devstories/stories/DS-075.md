---
id: DS-075
title: Add MCP tools for creating/updating stories
type: feature
epic: EPIC-015
status: todo
sprint: future-1
size: M
assignee: ""
dependencies:
  - [[DS-074]]
created: 2025-11-29
updated: 2025-11-29
---

# Add MCP tools for creating/updating stories

## Description
Add MCP tools so AI agents can create and update stories programmatically, enabling workflows like "plan this feature" or "mark story done".

## Acceptance Criteria

### Story Tools

**`create_story`**
- [ ] Required: `title` (string, max 200 chars)
- [ ] Optional: `type` (feature|bug|task|chore, default: task)
- [ ] Optional: `epic` (epic ID, default: INBOX or first epic)
- [ ] Optional: `sprint` (sprint name, default: backlog)
- [ ] Optional: `size` (XS|S|M|L|XL, default: M)
- [ ] Optional: `description` (markdown content)
- [ ] Optional: `dependencies` (array of story IDs)
- [ ] Returns: created story with generated ID

**`create_stories_batch`**
- [ ] Accept array of story definitions
- [ ] Validate all before creating any (atomic)
- [ ] Returns: array of created stories
- [ ] Use case: "Break this feature into 5 stories" creates all at once

**`update_story`**
- [ ] Required: `id` (story ID)
- [ ] Optional: any frontmatter field (title, status, sprint, size, etc.)
- [ ] Preserves markdown content unless `description` provided
- [ ] Returns: updated story

**`update_status`** (convenience shortcut)
- [ ] Required: `id`, `status`
- [ ] Validates status against config.yaml allowed values
- [ ] Returns: updated story

**`quick_capture`**
- [ ] Required: `title` only
- [ ] Creates story with defaults: type=task, status=todo, sprint=backlog, size=M
- [ ] Optional: `epic` (default: INBOX epic, create if doesn't exist)
- [ ] Returns: created story
- [ ] Use case: rapid capture during conversation

### Epic Tools

**`create_epic`**
- [ ] Required: `title` (string, max 100 chars)
- [ ] Optional: `goal` (description)
- [ ] Optional: `sprint` (default: backlog)
- [ ] Returns: created epic with generated ID

**`update_epic`**
- [ ] Required: `id`
- [ ] Optional: any frontmatter field
- [ ] Returns: updated epic

### Sprint Tools

**`assign_to_sprint`**
- [ ] Required: `ids` (array of story IDs), `sprint` (sprint name)
- [ ] Moves all specified stories to sprint
- [ ] Returns: updated stories

**`start_story`** (convenience)
- [ ] Required: `id`
- [ ] Sets status to `in_progress`
- [ ] Use case: "I'm starting work on DS-052"

**`complete_story`** (convenience)
- [ ] Required: `id`
- [ ] Sets status to `done`, updates `updated` timestamp
- [ ] Use case: "DS-052 is done"

### Validation & Errors

- [ ] Validate story/epic IDs exist before update
- [ ] Validate status values against config
- [ ] Validate epic IDs exist when assigning stories
- [ ] Validate dependencies exist and no circular deps
- [ ] Clear error messages: `{ error: "Epic EPIC-999 not found", code: "EPIC_NOT_FOUND" }`

### Testing

- [ ] Unit tests for each tool
- [ ] Test validation error cases
- [ ] Test batch creation atomicity
- [ ] Integration test: create → update → complete workflow

## Technical Notes

**Tool handler structure:**
```typescript
server.setRequestHandler(CallToolRequestSchema, async (request) => {
  switch (request.params.name) {
    case 'create_story':
      return handleCreateStory(request.params.arguments);
    case 'update_status':
      return handleUpdateStatus(request.params.arguments);
    // ...
  }
});
```

**Example AI interaction:**
```
User: "Plan the authentication feature"
AI: Uses create_stories_batch with 5 stories
AI: "Created 5 stories: DS-079 through DS-083 in EPIC-010"

User: "I'm starting DS-079"
AI: Uses start_story tool
AI: "DS-079 is now in progress"

User: "Done with that story"
AI: Uses complete_story tool
AI: "DS-079 marked complete. Next up: DS-080 (Add login form validation)"
```
