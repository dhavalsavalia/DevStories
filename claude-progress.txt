=== Archived 2025-12-04 ===
Sessions archived: 59
Date range: 2025-11-28 12:28  to  2025-12-02 14:55
Stories completed: 57

---

=== Session: 2025-12-02 14:50 ===
Stories: DS-165 (Changelog automation), DS-167 (CONTRIBUTING.md update)
Status: done

Changes:
- Created .github/release.yml for auto-generated release notes
  - Maps PR labels to changelog sections (feat→Features, fix→Bug Fixes, etc.)
- Updated CHANGELOG.md with note pointing to GitHub Releases
- Rewrote CONTRIBUTING.md:
  - Quick Start numbered steps
  - Branch naming convention (feat/, fix/, docs/, chore/)
  - PR process + labeling guide
  - Links to SECURITY.md and CODE_OF_CONDUCT.md
  - Kept concise

Files changed (5):
- .github/release.yml (new)
- CHANGELOG.md (updated)
- CONTRIBUTING.md (rewritten)
- .devstories/stories/DS-165.md (marked done)
- .devstories/stories/DS-167.md (marked done)

Tests: skipped (configuration/docs only)

=== Session: 2025-12-02 15:15 ===
Story: DS-160 (Configure branch protection for main)
Status: done

Changes:
- Configured GitHub branch protection via gh API
- Required status checks: test (20.x), test (22.x), integration-test
- Required 1 approval for PRs
- Blocked force pushes and branch deletion
- Added Branch Protection section to CONTRIBUTING.md with CLI reference

Files changed (2):
- CONTRIBUTING.md (Branch Protection section)
- .devstories/stories/DS-160.md (marked done)

Tests: skipped (configuration only)

=== Session: 2025-12-02 15:15 ===
Story: DS-161 (Configure tag protection for releases)
Status: done

Changes:
- Created repository ruleset "version-tags" via gh CLI API
- Pattern: refs/tags/v* (all version tags)
- Rules: deletion + update (prevents both)
- Bypass: Repository admins only
- Added Tag Protection section to CONTRIBUTING.md with CLI reference

Files changed (2):
- CONTRIBUTING.md (Tag Protection section)
- .devstories/stories/DS-161.md (marked done)

Tests: skipped (configuration only)

=== Session: 2025-12-02 15:22 ===
Story: DS-172 (Migrate to ESLint 9 flat config)
Status: done

Changes:
- Upgraded eslint 8.57.0 → 9.39.1
- Upgraded @typescript-eslint/* 7.x → 8.48.1
- Added typescript-eslint package for flat config API
- Created eslint.config.mjs (flat config format)
- Deleted .eslintrc.json
- Updated lint script (removed --ext ts flag)
- Removed deprecated @typescript-eslint/semi rule

Files changed (8):
- eslint.config.mjs (new)
- .eslintrc.json (deleted)
- package.json (deps + lint script)
- package-lock.json (deps)
- src/commands/changeStatusUtils.ts (removed unused eslint-disable)
- src/commands/createEpicUtils.ts (removed unused eslint-disable)
- src/commands/createStoryUtils.ts (removed unused eslint-disable)
- src/commands/saveAsTemplateUtils.ts (removed unused eslint-disable)
- src/core/configServiceUtils.ts (removed unused eslint-disable)

Tests: 413 unit + 134 integration (all passing)

=== Session: 2025-12-04 09:58 ===
Story: DS-174 (Backlog cleanup - close stale stories)
Status: done

Changes:
- Audited 21 todo stories in backlog
- Closed 3 stories not in v1.1.0+ roadmap:
  - DS-114: orphan epic EPIC-022, 1.0.0 verification (already released via EPIC-025)
  - DS-140: Insert Story Link command (deferred scope from 1.0.0)
  - DS-141: Template browser command (deferred scope from 1.0.0)
- Kept 18 todo stories:
  - DS-112, DS-113 (MCP - 1.2.0)
  - DS-120-125, DS-173 (Intellisense - 1.1.0)
  - DS-126-132, DS-151 (EPIC-INBOX backlog)

Files changed (4):
- .devstories/stories/DS-114.md (status: closed)
- .devstories/stories/DS-140.md (status: closed)
- .devstories/stories/DS-141.md (status: closed)
- .devstories/stories/DS-174.md (status: done)

Tests: N/A (chore - no code changes)

=== Session: 2025-12-04 10:41 ===
Story: DS-120 (JSON Schema definitions for frontmatter)
Status: done

Changes:
- Created schemas/defs/common.schema.json with shared definitions:
  - storyId, storyIdOrWikiLink, epicId patterns
  - dateString pattern
  - storyType, storySize enums
- Created schemas/story.schema.json with all story frontmatter fields
- Created schemas/epic.schema.json with all epic frontmatter fields
- Added ajv as devDependency for schema validation in tests
- Created src/test/unit/schemas.test.ts with 21 test cases

Files changed (7):
- schemas/defs/common.schema.json (new)
- schemas/story.schema.json (new)
- schemas/epic.schema.json (new)
- src/test/unit/schemas.test.ts (new)
- package.json (ajv devDependency)
- package-lock.json (updated)
- .devstories/stories/DS-120.md (status: done)

Tests: 434 unit + 134 integration (all passing)

=== Session: 2025-12-04 12:12 ===
Story: DS-121 (Single-file frontmatter validation)
Status: done

Changes:
- Added ajv-formats dependency for date format validation
- Created src/validation/frontmatterValidator.ts:
  - Pure validation functions using Ajv with JSON schemas
  - Normalizes gray-matter parsed dates back to strings
  - Returns errors with line numbers and column positions
  - Schema errors → Error severity, config mismatches → Warning severity
- Created src/validation/frontmatterDiagnostics.ts:
  - VS Code DiagnosticCollection provider
  - Validates on open, save (immediate), and change (300ms debounce)
  - Re-validates all open docs when config changes
- Registered FrontmatterDiagnosticsProvider in extension.ts
- Created comprehensive unit tests (32 tests)

Files changed (7):
- package.json (ajv-formats dependency)
- package-lock.json (updated)
- src/validation/frontmatterValidator.ts (new)
- src/validation/frontmatterDiagnostics.ts (new)
- src/test/unit/frontmatterValidator.test.ts (new)
- src/extension.ts (register diagnostics provider)
- .devstories/stories/DS-121.md (status: done)

Tests: 466 unit + 134 integration (all passing)

=== Session: 2025-12-04 12:30 ===
Story: DS-122 (Cross-file frontmatter validation)
Status: done

Changes:
- Added `validateCrossFile()` function to frontmatterValidator.ts
- Added `KnownIds` interface for cross-file validation context
- Updated `FrontmatterDiagnosticsProvider` to:
  - Accept Store in constructor
  - Build KnownIds from Store (stories, epics, epicStoryMap)
  - Subscribe to Store.onDidUpdate to revalidate when refs change
- Updated extension.ts to pass store to diagnostics provider

Validations implemented:
- Epic field: Error if epic doesn't exist (EPIC-INBOX always valid)
- Dependencies: Error if dependency doesn't exist or self-references
- [[ID]] links: Warning for broken links in markdown body
- ID uniqueness: Error if ID exists in opposite collection
- Orphan stories: Warning if story not listed in epic's ## Stories section

Files changed (4):
- src/validation/frontmatterValidator.ts (validateCrossFile, KnownIds)
- src/validation/frontmatterDiagnostics.ts (Store integration)
- src/extension.ts (pass store to diagnostics)
- src/test/unit/frontmatterValidator.test.ts (22 new tests)
- .devstories/stories/DS-122.md (status: done)

Tests: 488 unit + 134 integration (all passing)

=== Session: 2025-12-04 16:26 ===
Story: DS-123 (Autocomplete for enum fields)
Status: done

Changes:
- Created src/providers/frontmatterCompletionProviderUtils.ts:
  - detectFieldAtCursor() detects status/type/size/sprint fields
  - getStatusCompletions() returns config statuses with labels
  - getTypeCompletions() returns fixed types with descriptions
  - getSizeCompletions() returns config sizes with descriptions
  - getSprintCompletions() returns config sprint sequence
- Created src/providers/frontmatterCompletionProvider.ts:
  - FrontmatterCompletionProvider implements CompletionItemProvider
  - Registers with trigger chars ':' and ' '
  - Uses isInFrontmatter() from storyHoverProviderUtils
  - Returns null for non-.devstories files and non-frontmatter context
- Updated src/extension.ts to register completion provider
- Created comprehensive unit tests (23 tests)

Decision: Sprint completions use config.sprintSequence only (not existing story sprints)
Rationale: Validation catches typos, autocomplete provides valid options

Files changed (4):
- src/providers/frontmatterCompletionProviderUtils.ts (new)
- src/providers/frontmatterCompletionProvider.ts (new)
- src/test/unit/frontmatterCompletionProvider.test.ts (new)
- src/extension.ts (register provider)
- .devstories/stories/DS-123.md (status: done)

Tests: 511 unit + 134 integration (all passing)

=== Session: 2025-12-04 16:42 ===
Story: DS-124 (Autocomplete for references)
Status: done

Changes:
- Extended FrontmatterCompletionProvider to accept Store for ID lookups
- Added detectEpicField() to detect `epic:` field context
- Added detectDependencyContext() to detect YAML array items under `dependencies:`
- Added detectLinkTrigger() to detect `[[` pattern anywhere in file
- Added getEpicCompletions() for epic field (includes EPIC-INBOX)
- Added getStoryCompletions() for dependencies field
- Added getAllIdCompletions() for [[ID]] links (stories + epics)
- Updated extension.ts to pass Store and add `[` trigger character

Files changed (4):
- src/providers/frontmatterCompletionProviderUtils.ts (6 new functions)
- src/providers/frontmatterCompletionProvider.ts (Store integration)
- src/extension.ts (pass Store, add `[` trigger)
- src/test/unit/frontmatterCompletionProvider.test.ts (25 new tests)
- .devstories/stories/DS-124.md (status: done)

Tests: 536 unit + 134 integration (all passing)

=== Session: 2025-12-04 17:00 ===
Story: DS-125 (Hover documentation for frontmatter)
Status: done

Changes:
- Added `findFieldNameAtPosition()` to detect cursor on YAML field names
- Added `getFieldDescription()` with static schema descriptions (story/epic)
- Extended `StoryHoverProvider.provideHover()` to show field descriptions
- Hover shows: **fieldName** followed by description from schema
- File type (story/epic) determined from path

Note: Acceptance criteria 2-5 were already implemented. Only field name hover (criterion 1) needed new code.

Files changed (4):
- src/providers/storyHoverProviderUtils.ts (new functions)
- src/providers/storyHoverProvider.ts (field hover logic)
- src/test/unit/storyHoverProvider.test.ts (26 new tests)
- src/test/suite/storyHoverProvider.test.ts (5 new tests)

Tests: 562 unit + 139 integration (all passing)

=== Session: 2025-12-05 19:01 ===
Story: DS-177 (Fix hardcoded size suggestions)
Status: done

Changes:
- Updated `getSuggestedSize()` signature to accept `sizes: StorySize[]`
- Bug/Chore → first size (index 0), Feature → middle, Task → second
- Quick capture now uses `config.sizes[Math.floor(config.sizes.length / 2)]`
- Changed `StorySize` type from literal union to `string` for custom sizes

Files changed (6):
- src/types/story.ts (StorySize now string)
- src/commands/createStoryUtils.ts (getSuggestedSize signature)
- src/commands/createStory.ts (pass config.sizes)
- src/commands/quickCapture.ts (use middleSize)
- src/test/unit/createStory.test.ts (updated tests)
- src/test/suite/createStory.test.ts (updated integration test)
- .devstories/stories/DS-177.md (status: done)

Tests: 574 unit + 138 integration (all related tests passing)
Note: Pre-existing failing test in storiesProvider.test.ts (unrelated)
